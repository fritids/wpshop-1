<?php/** * Plugin Name: WP Shop Orders * Plugin URI: http://www.wpshop.fr/documentations/presentation-wpshop/ * Description : WPShop Orders * Version: 0.1 * Author: Eoxia * Author URI: http://eoxia.com/ *//** * Orders module bootstrap file * * @author ALLEGRE Jérôme - Eoxia dev team <dev@eoxia.com> * @version 0.1 * @package includes * @subpackage modules *//*	Check if file is include. No direct access possible with file url	*/if ( !defined( 'WPSHOP_VERSION' ) ) {	die( __('Access is not allowed by this way', 'wpshop') );}if ( !class_exists("wps_orders") ) {	class wps_orders {		function __construct() {			add_thickbox();			/** Template Load **/			add_filter( 'wpshop_custom_template', array( &$this, 'custom_template_load' ) );			add_shortcode( 'order_customer_informations', array( &$this, 'display_order_customer_informations' ) );		}				function custom_template_load( $templates ) {			include('templates/backend/main_elements.tpl.php');			$templates = wpshop_display::add_modules_template_to_internal( $tpl_element, $templates );			unset($tpl_element);					return $templates;		}						function display_order_customer_informations() {			global $post_id; global $wpdb; 			$output = '';						if ( !empty($post_id) ) {				$order_postmeta = get_post_meta( $post_id, '_order_postmeta', true );				/** Check the order status **/				if ( !empty($order_postmeta) ) {					if ( !empty($order_postmeta['order_status'])  && $order_postmeta['order_status'] != 'awaiting_payment' ) {						$tpl_component = array();						$output = wpshop_display::display_template_element('wps_orders_customer_informations', $tpl_component, array(), 'admin');					}				}			}			else {				/** Display  "Choose customer or create one" Interface **/					$tpl_component = array();				$args = array(							'show_option_all'         => __('Choose a customer', 'wpshop'), 							'orderby'                 => 'display_name',							'order'                   => 'ASC',							'include'                 => null, // string							'exclude'                 => null, // string							'multi'                   => false,							'show'                    => 'display_name',							'echo'                    => false,							'selected'                => false,							'include_selected'        => false,							'name'                    => 'user', // string							'id'                      => null, // integer							'class'                   => 'chosen_select', // string 							'blog_id'                 => $GLOBALS['blog_id'],							'who'                     => null // string						);				$tpl_component['CUSTOMERS_LIST'] = wp_dropdown_users( $args );				$output = wpshop_display::display_template_element('wps_orders_choose_customer_interface', $tpl_component, array(), 'admin');			}			return $output;		}					}}if (class_exists("wps_orders")){	$wps_orders = new wps_orders();}